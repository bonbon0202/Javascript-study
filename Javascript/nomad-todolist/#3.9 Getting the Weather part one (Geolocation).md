# Getting the Weather part 1. (Geolocation)



ìš°ë¦¬ëŠ” ì´ì œ ìœ ì €ì˜ location ì¢Œí‘œ ì •ë³´ë¥¼ ì½ì–´ì„œ 
ê·¸ ì •ë³´ë¥¼ ì €ì¥í•˜ê³  ì €ì¥ê°’ì´ ì—†ë‹¤ë©´ ìš”ì²­í•˜ê³ , ì €ì¥ê°’ì´ ìˆìœ¼ë©´ ì €ì¥ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ì¼ë“¤ì„ í•  ê²ƒì´ë‹¤. 

navigator, window, document ë“± ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆì§€ë§Œ, ìš°ë¦¬ëŠ” ì´ë²ˆì— navigatorë¥¼ ì´ìš©í•  ê²ƒì´ë‹¤.


ë¨¼ì € weather.js íŒŒì¼ì„ ë§Œë“¤ì–´ë³´ì.

 

    const  weather  =  document.querySelector(".js-weather");
    const  API_KEY  =  "9bc759acb6c1fe70d2bd4b0dcab41ef1";
    const  COORDS  =  "coords"; // coordinateì˜ ì•½ìë¡œ ì¢Œí‘œë¥¼ ì˜ë¯¸í•œë‹¤.

    function  getWeather(lat, lon) {  // ë‚ ì”¨ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
	fetch(  // 
	`http://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`
	).then(function  (response) {  // .then ì€ ì•ì— ìˆëŠ” ê²ƒì„ ë‹¤ ì™„ë£Œ í•œ ë’¤ì— ì‹¤í–‰í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ë‹¤.(ê³µë¶€í•˜ê¸°)
		return  response.json();  // jsonì„ ê°€ì ¸ì˜¬ ê²ƒì„. (js ì •ë³´)
	})
	.then(function  (json) {
		const  temperature  =  json.main.temp;
		const  place  =  json.name;
		weather.innerHTML  =  `${place}ì˜ ê¸°ì˜¨ì€ ${temperature}ë„ ì´ë„¤ìš”ğŸ¾`;
	});
	}

  
	function  saveCoords(coordsObj) {  // ì¢Œí‘œë¥¼ ë¡œì»¬ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
	localStorage.setItem(COORDS,  JSON.stringify(coordsObj));  // ë¡œì»¬ì— ì €ì¥í•´ì•¼í•˜ë‹ˆê¹Œ stringify í•´ì¤Œ
	}

	function  handleGeoSucces(position) {   // ìœ„ì¹˜ì ‘ê·¼ì— ì„±ê³µí–ˆì„ ê²½ìš° ì‹¤í–‰í•  í•¨ìˆ˜
		const  latitude  =  position.coords.latitude;  // ìœ„ë„
		const  longitude  =  position.coords.longitude;  // ê²½ë„
		const  coordsObj  =  {
			latitude,
			longitude,
		};
		saveCoords(coordsObj);
		getWeather(latitude,  longitude);
	}

	function  handleGeoError() {
		console.log("cant access geo location");
	}

	function  askForCoords() {
		navigator.geolocation.getCurrentPosition(handleGeoSucces,  handleGeoError);
	} // getCurrentPositionì€ ë©”ì„œë“œë¡œ, í˜„ì¬ìœ„ì¹˜ ì •ë³´ ì ‘ê·¼ì— ì„±ê³µí–ˆì„ ê²½ìš° ì‹¤í–‰í•  ì½œë°±í•¨ìˆ˜, ì ‘ê·¼ì— ì—ëŸ¬ìˆ                
	  // ì„ ê²½ìš°ì˜ ì½œë°±í•¨ìˆ˜, ì˜µì…˜ ë“± 3ê°œì˜ ì¸ìë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.) 

	function  loadCoords() {  // ì¢Œí‘œ í™”ë©´ì— ë¡œë“œí•´ì˜¤ëŠ” í•¨ìˆ˜
		const  loadedCoords  =  localStorage.getItem(COORDS);
		if (loadedCoords  ===  null) {  //ì¢Œí‘œê°€ ë¡œì»¬ì— ì €ì¥ë˜ì–´ìˆì§€ ì•Šì„ê²½ìš° askForCoords í•¨ìˆ˜ë¥¼ ì‹¤í–‰
			askForCoords();
		} else {
			const  parsedCoords  =  JSON.parse(loadedCoords);  //ë¡œì»¬ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ì •ë³´ì´ë¯€ë¡œ parseí•´ì¤€ë‹¤
			getWeather(parsedCoords.latitude,  parsedCoords.longitude);
		}
	}

	function  init() {
		loadCoords();
	}
	init();



##  WEATHER API


open APIë¥¼ í†µí•´ì„œ ì‚¬ëŒë“¤ì´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë¼ê³  ì œê³µí•´ì¤Œ. 
ì—¬ê¸° ë‚˜ì˜¨ URL ì˜ˆì œë¡œ REQUESTë¥¼ ë³´ë‚´ë©´ ë°ì´í„°ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.


[https://openweathermap.org/current#data](https://openweathermap.org/current#data) ì‚¬ì´íŠ¸ì—ì„œ 
API KEYS ì˜ KEYë¥¼ ë°›ì•„ì™€ì„œ 
`const API_KEY = ""` ì— ë‹´ì•„ì¤€ë‹¤.


## FETCH

ì–´ë–»ê²Œ JSë¥¼ ì´ìš©í•´ì„œ íŠ¹ì • URLì„ í˜¸ì¶œí•  ìˆ˜ ìˆì„ê¹Œ?
ì‚¬ì‹¤ ì´ ë¶€ë¶„ì´ ë°”ë¡œ JSê°€ ê°•í•´ì§„ ì´ìœ ì´ë‹¤.
ì™œëƒí•˜ë©´ JSëŠ” ì›¹ì‚¬ì´íŠ¸ë¡œ Requestë¥¼ ë³´ë‚´ê³  ì‘ë‹µì„ í†µí•´ì„œ ë°ì´í„°ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ”ë°
ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ refresh ì—†ì´ë„ ë‚˜ì˜ ì›¹ì‚¬ì´íŠ¸ì— ì ìš©ì‹œí‚¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´, ìš°ë¦¬ê°€ ì´ë©”ì¼ì„ í™•ì¸í•  ë•Œ, 
ì›¹ì‚¬ì´íŠ¸ë¥¼ ìƒˆë¡œê³ ì¹¨ í•˜ì§€ ì•Šì•„ë„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë©”ì¼ì´ ì˜¤ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ì´ëŠ” ì´ìœ ì´ë‹¤. 

ì™œëƒí•˜ë©´ jsê°€ ë³´ì´ì§€ ì•ŠëŠ” ê³³ì—ì„œ ê³„ì† ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.

